<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: head('HFPI Defect Dashboard')"></head>

<body>

<div class="container">

    <div th:replace="fragments/sidebar :: sidebar"></div>

    <div class="content">

        <h1>üìä HFPI Defect Dashboard</h1>

        <p>
            Factory:
            <strong th:text="${factory.name}"></strong>
        </p>

        <a th:href="@{/hfpi/{id}(id=${factory.id})}" class="btn-secondary">
            ‚¨Ö Back to HFPI Events
        </a>
		
		<!-- ===================== -->
		       <!-- PIZZA: Defeitos por descri√ß√£o -->
		       <!-- ===================== -->
		       <div class="card">
		           <h3>Defects by Description</h3>
		           <canvas id="defectPieChart"></canvas>
		       </div>

		       <!-- ===================== -->
		       <!-- BARRAS EMPILHADAS -->
		       <!-- ===================== -->
		       <div class="card">
		           <h3>Defects by Severity</h3>
		           <canvas id="defectStackedChart"></canvas>
		       </div>

        <br><br>

        <canvas id="defectChart" height="120"></canvas>

    </div>
</div>

<!-- ===================== -->
<!-- CHART.JS -->
<!-- ===================== -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script th:inline="javascript">
/* üçï PIZZA */
const pieLabels = /*[[${pieLabels}]]*/ [];
const pieValues = /*[[${pieValues}]]*/ [];

new Chart(document.getElementById('defectPieChart'), {
    type: 'pie',
    data: {
        labels: pieLabels,
        datasets: [{
            data: pieValues
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { position: 'right' }
        }
    }
});
</script>

<script th:inline="javascript">
/* üìä EMPILHADO */
const stackedLabels = /*[[${stackedLabels}]]*/ [];
const stackedMenor = /*[[${stackedMenor}]]*/ [];
const stackedModerado = /*[[${stackedModerado}]]*/ [];
const stackedSevero = /*[[${stackedSevero}]]*/ [];

new Chart(document.getElementById('defectStackedChart'), {
    type: 'bar',
    data: {
        labels: stackedLabels,
        datasets: [
            { label: 'Menor', data: stackedMenor },
            { label: 'Moderado', data: stackedModerado },
            { label: 'Severo', data: stackedSevero }
        ]
    },
    options: {
        responsive: true,
        scales: {
            x: { stacked: true },
            y: { stacked: true, beginAtZero: true }
        }
    }
});
</script>




</body>
</html>
